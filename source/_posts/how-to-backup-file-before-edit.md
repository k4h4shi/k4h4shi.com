---
title: 設定ファイル編集前にはファイルコピーを取る
date: 2017-09-16 14:42:43
tags:
- UNIX
- tips
---

UNIX系のファイルシステムでは、設定ファイルを編集する機会が多いです。

その際には、作業前に作業単位でバックアップを取ります。

## 作業前のファイルコピーを残しておく
大げさなことはせずとも、単純に設定ファイルのコピーを残しておくだけす。

その際のファイル名は、初期状態の設定ファイルは.org、途中時点の設定ファイルは.bkとつけることが多いです。

こうしておくことで、設定ミス時の復元や履歴管理が容易になります。

## 具体例
初期状態の設定ファイルを編集する際には、まず.org識別子をつけてコピーします。
その後、設定ファイルを編集します。

```
$ cp /etc/dhcpcd.conf /etc/dhcpcd.conf.org
$ vi /etc/dhcpcd.conf
```

もし動作確認後、問題が起きた場合、バックアップと編集後のdiffをとることで問題の原因を絞り込むことができます。

```
$ diff /etc/dhcpcd.conf /etc/dhcpcd.conf.org
```

初期設定からの変更時に必ず.orgファイルを残しておく。とすれば.orgファイルがあるものは初期設定から変更されていることを意味します。

```
$ ls -al | grep *.org
```

すでに.orgファイルが存在する状態で、さらに設定を編集するときは.bkをつけます。

```
$ cp /etc/dhcpcd.conf /etc/dhcpcd.conf.bk
$ vi /etc/dhcpcd.conf
```

問題が起きた場合は直前の変更とdiffをとります。

```
$ diff /etc/dhcpcd.conf /etc/dhcpcd.conf.bk
```

複数の.bkがあるときは、.bk20170917のように日付をつけることもあるようです。

## まとめ
情報系の技術に関しては基本的には失敗しても大丈夫なように作業を進める。ということが一番大事です。
また上記のステップは、開発時にgitを使ってコンソールデバッグを行う際などにも応用できる考え方です。
覚えておくといざという時に使えると思います。
